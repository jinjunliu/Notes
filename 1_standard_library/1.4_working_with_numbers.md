---
title: "Working with Numbers"
date: 2021-11-18T00:00:00-06:00
draft: false
weight: 24
---

This section discusses the operations on numbers in the Python standard library, such as generating random numbers, random sequences, encryption, etc.

## Working with Random Numbers

Computers use pseudo-random number generators (PRNGs) to generate random numbersã€‚It uses random seed value to derive a random number, typically used for statistical purposes, not to be used for security purposes. CSPRNGs (cryptographic secure pseudo-random number generators) are cryptographically secure PRNGs. CSRNGs are intended to be used for password generation, key generation, and other cryptographic purposes.

Python uses the `random` module to generate random numbers.

```python
import random
print(random.random())
```

To implement a coin toss program:

```python
import random
for i in range(10):
    print(random.choice(['heads', 'tails']))
```

We can specify the range of random numbers to be generated:

```python
import random
print(random.randint(1, 10)) # to generate a random integer between 1 and 10
print(random.uniform(1, 10)) # to generate a random float between 1 and 10
print(random.randrange(1, 10, 2)) # to generate a random integer between 1 and 10, but skipping even numbers
```

We can use `random.seed()` to set the seed value. For a fixed seed value, we can generate the same sequence of random numbers.

```python
import random
random.seed(1)
print(random.random())
```

No matter how many times we run the above program, the random number sequence will be the same. It is always `0.13436424411240122`. This is useful for reproducing a result, but it is not a good idea for security purposes.

## Random Sequences Operations

 We can use `choice` function to pick a random element from a sequence, for example:

```python
moves = ['rock', 'paper', 'scissors']
print(random.choice(moves))
```

The output is a random element from the sequence, for example `'paper'`. Python 3.6 can use `choices` (with an s) to select multiple elements, and can use weights to specify the probability of each element, for example:

```python
weights = [1, 2, 3] # weights for each element, probabilities are 1/6, 2/6, 3/6
print(random.choices(moves, weights, k=5)) # pick 5 elements
```

Elements will be selected with replacement by `choices`, but not by `sample`. This means the output could contain duplicate elements when using `choices`, but not when using `sample`.

```python
print(random.sample(moves, 2))
```

`shuffle` is used to shuffle a sequence, for example:

```python
random.shuffle(moves)
print(moves)
```

If the sequence is immutable, we can first use `sample` to pick some elements, and then use `shuffle` to shuffle the elements.

```python
import string
result = random.sample(string.ascii_lowercase, k=len(string.ascii_lowercase))
random.shuffle(result)
print(result)
```

The output is a random permutation of the elements in the sequence.

## Cryptographic random operations

Starting from Python 3.6, there is a `secrets` module that provides secure random number generators, such as generating passwords, keys, and so on. `os` module provides `urandom` function to read random bytes from the `/dev/urandom` device, which is the base of `secrets` module. The following code is to generate 16 bytes of random data using `os` module's `urandom` function:

```python
import os
result = os.urandom(16)
print([hex(b) for b in result]) # convert bytes to hexadecimal
```

We don't need to use `urandom` because `secrets` provides higher-level random number generators, such as `secrets.choice` to pick a random element from a sequence, for example:

```python
import secrets
print(secrets.choice(moves))
```

We can use `secrets.token_bytes` to generate a random byte sequence of a specified length:

```python
import secrets
print(secrets.token_bytes(16))
```

we can use `secrets.token_hex` to generate a random hexadecimal string of a specified length:

```python
import secrets
print(secrets.token_hex(16))
```

## Temporary Paswords and URLs

By using `secrets.choice` function, we can pick a random element from a sequence. It can be used to generate a temporary password.

```python
import secrets
import string
results = "".join(secrets.choice(string.ascii_letters + string.digits) for i in range(8)) # generate a random password of 8 characters, including letters and digits
print(results)
```

The output is a random password of 8 characters, including letters and digits.

To enforce 1 number and 1 uppercase letter, use:

```python
import secrets
import string
potentialChars = string.ascii_letters + string.digits + "!@#$%^&*()"
while True:
    results = "".join(secrets.choice(potentialChars) for i in range(8))
    if (any(c.isdigit() for c in results) and any(c.isupper() for c in results)):
        print(results)
        break
```

We can see the output is a random 8-character string with at least one number and one uppercase letter.

We can use `secrets.token_urlsafe` to generate a temporary, hard-to-guess URL-safe string:

```python
result_url = "https://my.example.com/?reset=" + secrets.token_urlsafe(16)
print(result_url)
```

The output is a random URL-safe string like `https://my.example.com/reset=?DyFTgxUM87r_TVoWTG4UZg`. This function can be used to generate a temporary and safe url to user for a variety of purposes (e.g. resetting a password, sending an email, etc.).
